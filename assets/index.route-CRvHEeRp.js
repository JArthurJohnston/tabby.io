import{u,j as e,E as h,a as j,r as w}from"./index-DBqB6T6u.js";import{N as f}from"./NoteFingerChart-vrDdgDbs.js";function v(){const{current:s}=u();return e.jsxs("div",{className:"bordered flex col mr",children:[s.fingering.slice().reverse().map((r,t)=>e.jsx(N,{scale:.7,children:r},`${s.id}-${r}-${t}`)),e.jsx(b,{})]})}function N({children:s,background:r="white",color:t="black",scale:n=1}){return e.jsxs("svg",{height:100*n,width:100*n,xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{r:45*n,cx:50*n,cy:50*n,fill:r}),e.jsx("text",{x:50*n,y:60*n,fontSize:30*n,textAnchor:"middle",fill:t,children:s})]})}function b({stroke:s="white",fill:r="white",scale:t=1}){return e.jsx("svg",{height:100*t,width:100*t,version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("rect",{x:35*t,y:30*t,height:30*t,width:30*t,stroke:s,fill:r,strokeWidth:"5"})})}function E({lines:s}){return e.jsx("div",{style:{height:"93%",overflowX:"scroll",width:"50vw"},className:"flex col ml full-width",children:s.map((r,t)=>e.jsx("div",{className:"flex row mb",children:r.map((n,c)=>e.jsx(C,{note:n},`${n?.fingering}-${c}`))},`line-${t}`))})}function C({note:s}){return s===h?e.jsx(y,{}):e.jsx(f,{note:s,scale:.25})}function y(){return e.jsxs("div",{className:"mr",style:{width:"1rem"},children:["-",e.jsx("br",{}),"-",e.jsx("br",{}),"-",e.jsx("br",{}),"-"]})}function S(s,r){return s.split(`
`).map(n=>$(n,r))}const $=(s,r)=>s.split(" ").map(t=>{let n=!1,c=null,o=null;return t===""?h:(t.split("").forEach(i=>{const a=parseInt(i);if(a){c=a;return}if(i==="#"){n=!0;return}o=i}),T(r,o,c,n))});function T(s,r,t,n){if(!r)return;const c=r.toUpperCase();let o=s.notes.filter(i=>i.note.toUpperCase()===c);return t&&n?o.find(i=>i.octave===t&&i.sharp):t&&!n?o.find(i=>i.octave===t&&!i.sharp):n?o.find(i=>i.sharp):o[0]}function I(){const{title:s,arrangement:r,setCurrent:t,compositions:n,updateArrangement:c,updateTitle:o}=j(),{current:i}=u(),a=w.useRef(),x=l=>{const{value:d}=l.target;R.test(d)&&c(d)},m=l=>{const d=l.target.value,p=n.find(g=>g.id==d);t(p)};return e.jsxs("div",{className:"flex col full-width bordered align-start",children:[e.jsxs("div",{className:"flex row full-width jsb",children:[e.jsx("input",{className:"ml mt",type:"text",style:{width:"50%"},value:s,onChange:l=>o(l.target.value)}),e.jsx("select",{className:"mr",id:"compositions-select",onChange:m,children:n.map(l=>e.jsx("option",{value:l.id,children:l.title},l.id))})]}),e.jsxs("div",{className:"flex row full-width full-height",children:[e.jsx("textarea",{ref:a,className:"margins",style:{height:"60%",width:"45%",borderRadius:"0.5rem"},value:r,onChange:x,onSelect:l=>{console.log("SELECTION",l.target.selectionStart)}}),e.jsx(E,{lines:S(r,i),instrument:i,arrangement:r,index:a.current?.selectionStart})]})]})}const R=/^[a-gA-G0-9\#\s]*$/;function A(){const{current:s}=u();return e.jsx("div",{className:"flex row full-width jsb",children:s.notes.map(r=>e.jsx(f,{note:r,scale:.25},`${s.id}-${r.fingering}`))})}const U=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex mb",style:{height:"65vh"},children:[e.jsx(v,{}),e.jsx(I,{})]}),e.jsx(A,{})]});export{U as component};
